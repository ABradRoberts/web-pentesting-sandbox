from flask import Blueprint, request, template
import urllib.request

ssrf = Blueprint("ssrf", __name__, template_folder='templates

@ssrf.route("/ssrf",methods=['GET', 'POST'])
def ssrf_vuln():
	if request.method == 'GET':
		if request.args.get('url'):
			try:  # This is where the vulnerable code is that makes this work
				webUrl = urllib.request.urlopen(request.args.get('url'))
				data = webUrl.read()
				return data, 200
			except Exception as e:
				print(e)
		else:
			return render_template("ssrf.html"), 200

	return str("ERROR: You're either doing something really weird... or you just need 'http://' in front of your url...".format(request.method)), 200
